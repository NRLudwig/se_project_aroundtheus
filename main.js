!function(){"use strict";class e{constructor(e,t,n){this._title=e.name,this._link=e.link,this._cardSelector=t,this._handleLikeButton=n.handleLike,this._handleDeleteButton=n.handleDelete,this._handleImageClick=n.handleImageClick}_getTemplate(){return this.cardElement=document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0),this.cardElement}generateCard(e){return this.cardElement=this._getTemplate(),this.cardElement.querySelector(".card__image").src=this._link,this.cardElement.querySelector(".card__image").alt=this._title,this.cardElement.querySelector(".card__title").textContent=this._title,this._setEventListeners(e),this.cardElement}_setEventListeners(e){e.isLiked?this.cardElement.querySelector(".card__heart-button").classList.add("card__heart-button_active"):this.cardElement.querySelector(".card__heart-button").classList.remove("card__heart-button_active"),this.cardElement.querySelector(".card__heart-button").addEventListener("click",(()=>{this.cardElement.querySelector(".card__heart-button").classList.toggle("card__heart-button_active"),this._handleLikeButton(e)})),this.cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteButton(this.cardElement,e)})),this.cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(e)}))}}class t{constructor(e,t){this.configObj=e,this.formElement=t,this.btn=this.formElement.querySelector(this.configObj.submitBtn),this.inputList=Array.from(this.formElement.querySelectorAll(this.configObj.input))}_setEventListeners(){this.inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}_checkInputValidity(e){e.validity.valid?this.hideInputError(e):this.showInputError(e)}toggleButtonState(){this.inputList.every((e=>e.validity.valid))?this.btn.disabled=!1:this.btn.disabled=!0}resetValidation(){this.toggleButtonState(),this.inputList.forEach((e=>{this.hideInputError(e)}))}showInputError(e){this.formElement.querySelector(`.${e.id}_error`).textContent=e.validationMessage}hideInputError(e){this.formElement.querySelector(`.${e.id}_error`).textContent=""}enableValidation(){this.formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class n{constructor(e){this._popUpElement=document.querySelector(e),this.closeButton=this._popUpElement.querySelector(".modal__button-close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popUpElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popUpElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.code&&this.close()}setEventListeners(){this._popUpElement.addEventListener("mousedown",(e=>{e.target.classList.contains("modal_opened")&&this.close(),e.target.classList.contains("modal__button-close")&&this.close()}))}}class r extends n{constructor(e,t){super(e),this._formInputs=this._popUpElement.querySelectorAll(".modal__text-input"),this.formElement=this._popUpElement.querySelector(".modal__form"),this.formSubmitHandler=t,this._handleSubmitClick=this._handleSubmitClick.bind(this),this._saveButton=this.formElement.querySelector(".modal__button-save")}_handleSubmitClick(e){e.preventDefault(),this.renderSaving(!0);const t=this._getInputValues();this.formSubmitHandler(t),this.close(),this.formElement.reset()}_getInputValues(){return this._inputData={},this._formInputs.forEach((e=>{this._inputData[e.name]=e.value})),this._inputData}setEventListeners(){super.setEventListeners(),this.formElement.addEventListener("submit",this._handleSubmitClick)}setDeleteSubmitListener(e,t){super.setEventListeners(),this.formElement.addEventListener("submit",(n=>{n.preventDefault(),this.formSubmitHandler(e,t),this.close(),this.formElement.reset()}))}renderSaving(e){this._saveButton.textContent=e?"Saving...":"Save"}}const s=document.querySelector(".gallery"),o=document.querySelector(".profile__image_wrapper"),a=document.querySelector(".modal__form_profile"),i=document.querySelector(".modal__form_new-place"),l=document.querySelector(".modal__form_change-avatar"),c=document.querySelector(".modal__form_delete"),h=document.querySelector(".modal__text-input_type_name"),d=document.querySelector(".modal__text-input_type_subtitle"),u=document.querySelector(".profile__edit-button"),m=document.querySelector(".profile__add-button"),_={form:".modal__form",input:".modal__text-input",submitBtn:".modal__button-save"},p=new class{constructor(e){this._nameElement=document.querySelector(e.name),this._aboutElement=document.querySelector(e.about),this._avatarElement=document.querySelector(e.avatar)}getUserInfo(){return this._userData={name:this._nameElement.textContent,about:this._aboutElement.textContent},this._userData}setUserInfo(e){this._nameElement.textContent=e.name,this._aboutElement.textContent=e.about}setUserAvatar(e){this._avatarElement.src=e.url}}({name:".profile__name",about:".profile__subtitle",avatar:".profile__image"}),E={handleDelete:function(e,t){I(k),k.setDeleteSubmitListener(e,t)},handleLike:function(e){U.likeCard(e)},handleImageClick:function(e){L.open(e)}},f={setUserInfo:function(e){p.setUserInfo(e)},cardRequest:function(e){$(v,e)},setAvatar:function(e){p.setUserAvatar(e)},renderSavingProfileForm:function(){j.renderSaving(!1)},renderSavingAvatarForm:function(){q.renderSaving(!1)},renderSavingNewCardForm:function(){C.renderSaving(!1)}},v=new class{constructor(e,t){this._gallery=t,this.renderer=e}renderItems(){console.log(items),items.forEach((e=>{this.renderer(this._gallery,e),console.log(e)}))}renderItem(e){this._gallery.prepend(e)}}($,s),b=new t(_,a),g=new t(_,i),S=new t(_,l),y=new t(_,c),k=new r(".modal_delete",(function(e,t){e.remove(),U.deleteCard(t)})),L=new class extends n{constructor(e){super(e),this.imageElement=this._popUpElement.querySelector(".modal-picture__image"),this.titleElement=this._popUpElement.querySelector(".modal-picture__title")}open(e){this.imageElement.src=e.link,this.imageElement.alt=e.name,this.titleElement.textContent=e.name,super.open()}}(".modal_picture"),C=new r(".modal_new-place",(function(e){U.postCard(e)})),j=new r(".modal_profile-edit",(function(e){U.updateUserData(e),p.setUserInfo(e)})),q=new r(".modal_change-avatar",(function(e){U.patchAvatar(e),p.setUserAvatar(e)})),U=new class{constructor(e,t,n){this.baseUrl=e,this.token=t,this.funcObj=n}getUserData(){fetch(`${this.baseUrl}/users/me`,{headers:{authorization:this.token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.stauts}`))).then((e=>{this.funcObj.setUserInfo(e)})).catch((e=>{console.error(e)}))}updateUserData(e){fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:{authorization:this.token,"content-type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{console.log(e),this.funcObj.renderSavingProfileForm()})).catch((e=>{console.error(e)}))}getInitaialCards(){fetch(`${this.baseUrl}/cards`,{headers:{authorization:this.token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{e.forEach((e=>{this.funcObj.cardRequest(e)}))})).catch((e=>{console.error(e)}))}postCard(e){fetch(`${this.baseUrl}/cards`,{method:"POST",headers:{authorization:this.token,"content-type":"application/json"},body:JSON.stringify({name:e.title,link:e.link})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{console.log(e),this.funcObj.cardRequest(e),this.funcObj.renderSavingNewCardForm()})).catch((e=>{console.log("this is postCard catch"),console.error(e)}))}deleteCard(e){fetch(`${this.baseUrl}/cards/${e._id}`,{method:"DELETE",headers:{authorization:this.token,"content-type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then(console.log(`${e.name} id-${e._id} has been deleted`)).catch((e=>{console.error(e)}))}likeCard(e){e.isLiked?fetch(`${this.baseUrl}/cards/${e._id}/likes`,{method:"DELETE",headers:{authorization:this.token,"content-type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)})):fetch(`${this.baseUrl}/cards/${e._id}/likes`,{method:"PUT",headers:{authorization:this.token,"content-type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}patchAvatar(e){fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this.token,"content-type":"application/json"},body:JSON.stringify({avatar:e.url})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{this.funcObj.setAvatar({url:e.avatar}),this.funcObj.renderSavingAvatarForm()})).catch((e=>{console.log(e),console.error(e)}))}getAvatar(){fetch(`${this.baseUrl}/users/me`,{headers:{authorization:this.token,"content-type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{this.funcObj.setAvatar({url:e.avatar})})).catch((e=>{console.error(e)}))}getServerData(){this.getUserData(),this.getAvatar(),this.getInitaialCards()}}("https://around-api.en.tripleten-services.com/v1","84b07c5a-0111-4c47-905f-ba8750f58c8b",f);function I(e){e.open()}function $(t,n){const r=function(t){return new e(t,"#card__template",E).generateCard(t)}(n);t.renderItem(r)}b.enableValidation(),g.enableValidation(),S.enableValidation(),y.enableValidation(),U.getServerData(),C.setEventListeners(),L.setEventListeners(),j.setEventListeners(),q.setEventListeners(),o.addEventListener("click",(function(){I(q),S.toggleButtonState()})),u.addEventListener("click",(function(){const e=p.getUserInfo();h.value=e.name,d.value=e.about,I(j),b.resetValidation()})),m.addEventListener("click",(()=>{I(C),g.toggleButtonState()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCBmdW5jdGlvbk9iamVjdCkge1xuICAgIHRoaXMuX3RpdGxlID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24gPSBmdW5jdGlvbk9iamVjdC5oYW5kbGVMaWtlO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbiA9IGZ1bmN0aW9uT2JqZWN0LmhhbmRsZURlbGV0ZTtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gZnVuY3Rpb25PYmplY3QuaGFuZGxlSW1hZ2VDbGljaztcbiAgfVxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgdGhpcy5jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIHRoaXMuY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoY2FyZERhdGFPYmopIHtcbiAgICB0aGlzLmNhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLmNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIikuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLmNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIikuYWx0ID0gdGhpcy5fdGl0bGU7XG4gICAgdGhpcy5jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoY2FyZERhdGFPYmopO1xuICAgIHJldHVybiB0aGlzLmNhcmRFbGVtZW50O1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKGNhcmREYXRhT2JqKSB7XG4gICAgaWYgKGNhcmREYXRhT2JqLmlzTGlrZWQpIHtcbiAgICAgIHRoaXMuY2FyZEVsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faGVhcnQtYnV0dG9uXCIpXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9faGVhcnQtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgICB0aGlzLmNhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLmNhcmRFbGVtZW50XG4gICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faGVhcnQtYnV0dG9uXCIpXG4gICAgICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKGNhcmREYXRhT2JqKTtcbiAgICAgIH0pO1xuICAgIHRoaXMuY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24odGhpcy5jYXJkRWxlbWVudCwgY2FyZERhdGFPYmopO1xuICAgICAgfSk7XG4gICAgdGhpcy5jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhT2JqKTtcbiAgICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZ09iaiwgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLmNvbmZpZ09iaiA9IGNvbmZpZ09iajtcbiAgICB0aGlzLmZvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5idG4gPSB0aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5jb25maWdPYmouc3VibWl0QnRuKTtcbiAgICB0aGlzLmlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5jb25maWdPYmouaW5wdXQpXG4gICAgKTtcbiAgfVxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkge1xuICAgIGlmICghaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuc2hvd0lucHV0RXJyb3IoaW5wdXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhpZGVJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAoXG4gICAgICB0aGlzLmlucHV0TGlzdC5ldmVyeSgoaW5wdXQpID0+IHtcbiAgICAgICAgcmV0dXJuIGlucHV0LnZhbGlkaXR5LnZhbGlkO1xuICAgICAgfSlcbiAgICApIHtcbiAgICAgIHRoaXMuYnRuLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuXG4gICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuaGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgIH0pO1xuICB9XG5cbiAgc2hvd0lucHV0RXJyb3IoaW5wdXQpIHtcbiAgICBjb25zdCBlcnJvclNwYW5FbGUgPSB0aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0LmlkfV9lcnJvcmApO1xuICAgIGVycm9yU3BhbkVsZS50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICB9XG4gIGhpZGVJbnB1dEVycm9yKGlucHV0KSB7XG4gICAgY29uc3QgZXJyb3JTcGFuRWxlID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH1fZXJyb3JgKTtcbiAgICBlcnJvclNwYW5FbGUudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLmZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3BVcFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wVXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3BVcFNlbGVjdG9yKTtcbiAgICB0aGlzLmNsb3NlQnV0dG9uID0gdGhpcy5fcG9wVXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvbi1jbG9zZVwiKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcFVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3BVcEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgY29uc3QgY29kZSA9IGV2dC5jb2RlO1xuICAgIGlmIChjb2RlID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wVXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19idXR0b24tY2xvc2VcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wVXBTZWxlY3RvciwgZm9ybVN1Ym1pdEhhbmRsZXIpIHtcbiAgICBzdXBlcihwb3BVcFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtSW5wdXRzID1cbiAgICAgIHRoaXMuX3BvcFVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX190ZXh0LWlucHV0XCIpO1xuICAgIHRoaXMuZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3BVcEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLmZvcm1TdWJtaXRIYW5kbGVyID0gZm9ybVN1Ym1pdEhhbmRsZXI7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0Q2xpY2sgPSB0aGlzLl9oYW5kbGVTdWJtaXRDbGljay5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvbi1zYXZlXCIpO1xuICB9XG5cbiAgX2hhbmRsZVN1Ym1pdENsaWNrKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMucmVuZGVyU2F2aW5nKHRydWUpO1xuICAgIGNvbnN0IGlucHV0RGF0YSA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG4gICAgdGhpcy5mb3JtU3VibWl0SGFuZGxlcihpbnB1dERhdGEpO1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgICB0aGlzLmZvcm1FbGVtZW50LnJlc2V0KCk7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5faW5wdXREYXRhID0ge307XG4gICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgdGhpcy5faW5wdXREYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RGF0YTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdENsaWNrKTtcbiAgfVxuXG4gIHNldERlbGV0ZVN1Ym1pdExpc3RlbmVyKGNhcmQsIGRhdGEpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuZm9ybVN1Ym1pdEhhbmRsZXIoY2FyZCwgZGF0YSk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB0aGlzLmZvcm1FbGVtZW50LnJlc2V0KCk7XG4gICAgfSk7XG4gIH1cblxuICByZW5kZXJTYXZpbmcoaXNTYXZpbmcpIHtcbiAgICBpZiAoaXNTYXZpbmcpIHtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfVxuICB9XG59XG4iLCIvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAgZWxlbWVudHMgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5leHBvcnQgY29uc3QgY2FyZEdhbGxlcnlFTCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeVwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJPdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZV93cmFwcGVyXCIpO1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gIGZvcm1zICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybV9wcm9maWxlXCIpO1xuZXhwb3J0IGNvbnN0IG5ld1BsYWNlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1fbmV3LXBsYWNlXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtX2NoYW5nZS1hdmF0YXJcIik7XG5leHBvcnQgY29uc3QgaW1hZ2VEZWxldGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybV9kZWxldGVcIik7XG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAgaW5wdXRzICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuZXhwb3J0IGNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3RleHQtaW5wdXRfdHlwZV9uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IGlucHV0U3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fdGV4dC1pbnB1dF90eXBlX3N1YnRpdGxlXCJcbik7XG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAgYnV0dG9ucyAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgYWRkTmV3SW1hZ2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAgb2JqZWN0cyAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGZvcm06IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0OiBcIi5tb2RhbF9fdGV4dC1pbnB1dFwiLFxuICBzdWJtaXRCdG46IFwiLm1vZGFsX19idXR0b24tc2F2ZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHVzZXJJbmZvT2JqID0ge1xuICBuYW1lOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIGFib3V0OiBcIi5wcm9maWxlX19zdWJ0aXRsZVwiLFxuICBhdmF0YXI6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59O1xuXG4vLyB0ZXN0XG5cbmV4cG9ydCBjb25zdCBzZXJ2ZXJUb2tlbiA9IFwiODRiMDdjNWEtMDExMS00YzQ3LTkwNWYtYmE4NzUwZjU4YzhiXCI7XG4iLCJpbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBjYXJkR2FsbGVyeUVMLFxuICBwcm9maWxlRm9ybSxcbiAgbmV3UGxhY2VGb3JtLFxuICBpbnB1dE5hbWUsXG4gIGlucHV0U3VidGl0bGUsXG4gIHByb2ZpbGVFZGl0QnRuLFxuICBhZGROZXdJbWFnZUJ0bixcbiAgY29uZmlnLFxuICB1c2VySW5mb09iaixcbiAgc2VydmVyVG9rZW4sXG4gIGF2YXRhckZvcm0sXG4gIGF2YXRhck92ZXJsYXksXG4gIGltYWdlRGVsZXRlRm9ybSxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuY29uc3QgdXNlciA9IG5ldyBVc2VySW5mbyh1c2VySW5mb09iaik7XG5jb25zdCBoYW5kbGVyRnVuY3Rpb25zID0ge1xuICBoYW5kbGVEZWxldGU6IGZ1bmN0aW9uIGhhbmRsZURlbGV0ZShjYXJkLCBkYXRhKSB7XG4gICAgb3BlblBvcHVwKHBvcHVwSW1hZ2VEZWxldGUpO1xuICAgIHBvcHVwSW1hZ2VEZWxldGUuc2V0RGVsZXRlU3VibWl0TGlzdGVuZXIoY2FyZCwgZGF0YSk7XG4gIH0sXG4gIGhhbmRsZUxpa2U6IGZ1bmN0aW9uIGhhbmRsZUxpa2UoZGF0YSkge1xuICAgIGFwaUNhbGwubGlrZUNhcmQoZGF0YSk7XG4gIH0sXG4gIGhhbmRsZUltYWdlQ2xpY2s6IGZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soZGF0YSkge1xuICAgIHBvcHVwV2l0aEltYWdlLm9wZW4oZGF0YSk7XG4gIH0sXG59O1xuY29uc3QgYXBpRnVuY3Rpb25PYmogPSB7XG4gIHNldFVzZXJJbmZvOiBmdW5jdGlvbiBhcGlTZXRVc2VySW5mb0NhbGxiYWNrKGRhdGEpIHtcbiAgICB1c2VyLnNldFVzZXJJbmZvKGRhdGEpO1xuICB9LFxuICBjYXJkUmVxdWVzdDogZnVuY3Rpb24gYXBpQ2FyZFJlcXVlc3RDYWxsYmFjayhkYXRhKSB7XG4gICAgY2FyZFJlbmRlcmVyKGdhbGxlcnlTZWN0aW9uLCBkYXRhKTtcbiAgfSxcbiAgc2V0QXZhdGFyOiBmdW5jdGlvbiBhcGlTZXRBdmF0YXJDYWxsYmFjayhkYXRhKSB7XG4gICAgdXNlci5zZXRVc2VyQXZhdGFyKGRhdGEpO1xuICB9LFxuICByZW5kZXJTYXZpbmdQcm9maWxlRm9ybTogZnVuY3Rpb24gcmVuZGVyU2F2aW5nKCkge1xuICAgIHBvcHVwRWRpdFByb2ZpbGVGb3JtLnJlbmRlclNhdmluZyhmYWxzZSk7XG4gIH0sXG4gIHJlbmRlclNhdmluZ0F2YXRhckZvcm06IGZ1bmN0aW9uIHJlbmRlclNhdmluZygpIHtcbiAgICBwb3B1cEF2YXRhckZvcm0ucmVuZGVyU2F2aW5nKGZhbHNlKTtcbiAgfSxcbiAgcmVuZGVyU2F2aW5nTmV3Q2FyZEZvcm06IGZ1bmN0aW9uIHJlbmRlclNhdmluZygpIHtcbiAgICBwb3B1cE5ld0NhcmRGb3JtLnJlbmRlclNhdmluZyhmYWxzZSk7XG4gIH0sXG59O1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAgICBzZWN0aW9ucyAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuY29uc3QgZ2FsbGVyeVNlY3Rpb24gPSBuZXcgU2VjdGlvbihjYXJkUmVuZGVyZXIsIGNhcmRHYWxsZXJ5RUwpO1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAgIFZBTElEQVRPUlMgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuY29uc3QgcHJvZmlsZVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUZvcm0pO1xuY29uc3QgbmV3UGxhY2VWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIG5ld1BsYWNlRm9ybSk7XG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhdmF0YXJGb3JtKTtcbmNvbnN0IGltYWdlRGVsZXRlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgaW1hZ2VEZWxldGVGb3JtKTtcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gICBQT1BVUFMgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmNvbnN0IHBvcHVwSW1hZ2VEZWxldGUgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIubW9kYWxfZGVsZXRlXCIsXG4gIGhhbmRsZURlbGV0ZUZvcm1TdWJtaXRcbik7XG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5tb2RhbF9waWN0dXJlXCIpO1xuY29uc3QgcG9wdXBOZXdDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIi5tb2RhbF9uZXctcGxhY2VcIixcbiAgaGFuZGxlRm9ybUNhcmRTdWJtaXRcbik7XG5jb25zdCBwb3B1cEVkaXRQcm9maWxlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIi5tb2RhbF9wcm9maWxlLWVkaXRcIixcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXRcbik7XG5jb25zdCBwb3B1cEF2YXRhckZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIubW9kYWxfY2hhbmdlLWF2YXRhclwiLFxuICBoYW5kbGVBdmF0YXJGb3JtU3VibWl0XG4pO1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAgIEFQSSAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuY29uc3QgYXBpQ2FsbCA9IG5ldyBBcGkoXG4gIFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgc2VydmVyVG9rZW4sXG4gIGFwaUZ1bmN0aW9uT2JqXG4pO1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyAgIEZVTkNUSU9OUyAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuZnVuY3Rpb24gaGFuZGxlRGVsZXRlRm9ybVN1Ym1pdChjYXJkLCBkYXRhKSB7XG4gIGNhcmQucmVtb3ZlKCk7XG4gIGFwaUNhbGwuZGVsZXRlQ2FyZChkYXRhKTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZGF0YSkge1xuICBhcGlDYWxsLnBhdGNoQXZhdGFyKGRhdGEpO1xuICB1c2VyLnNldFVzZXJBdmF0YXIoZGF0YSk7XG59XG5mdW5jdGlvbiBvcGVuUG9wdXAocG9wdXApIHtcbiAgcG9wdXAub3BlbigpO1xufVxuZnVuY3Rpb24gaGFuZGxlRm9ybUNhcmRTdWJtaXQoZGF0YSkge1xuICBhcGlDYWxsLnBvc3RDYXJkKGRhdGEpO1xufVxuZnVuY3Rpb24gY2FyZFJlbmRlcmVyKHNlY3Rpb24sIGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IGNyZWF0Q2FyZChkYXRhKTtcbiAgc2VjdGlvbi5yZW5kZXJJdGVtKGNhcmQpO1xufVxuZnVuY3Rpb24gY3JlYXRDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGRhdGEsIFwiI2NhcmRfX3RlbXBsYXRlXCIsIGhhbmRsZXJGdW5jdGlvbnMpO1xuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoZGF0YSk7XG59XG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChkYXRhKSB7XG4gIGFwaUNhbGwudXBkYXRlVXNlckRhdGEoZGF0YSk7XG4gIHVzZXIuc2V0VXNlckluZm8oZGF0YSk7XG59XG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vICAgT04gTE9BRCAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5wcm9maWxlVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbm5ld1BsYWNlVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuaW1hZ2VEZWxldGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFwaUNhbGwuZ2V0U2VydmVyRGF0YSgpO1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLyAgIEVWRU5UIExJU1RFTkVSUyAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xucG9wdXBOZXdDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBvcHVwRWRpdFByb2ZpbGVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5wb3B1cEF2YXRhckZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmF2YXRhck92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgb3BlblBvcHVwKHBvcHVwQXZhdGFyRm9ybSk7XG4gIGF2YXRhckZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbn0pO1xucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgdXNlclByb2ZpbGUgPSB1c2VyLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0TmFtZS52YWx1ZSA9IHVzZXJQcm9maWxlLm5hbWU7XG4gIGlucHV0U3VidGl0bGUudmFsdWUgPSB1c2VyUHJvZmlsZS5hYm91dDtcbiAgb3BlblBvcHVwKHBvcHVwRWRpdFByb2ZpbGVGb3JtKTtcbiAgcHJvZmlsZVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuYWRkTmV3SW1hZ2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3BlblBvcHVwKHBvcHVwTmV3Q2FyZEZvcm0pO1xuICBuZXdQbGFjZVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xufSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHVzZXJJbmZvT2JqKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJJbmZvT2JqLm5hbWUpO1xuICAgIHRoaXMuX2Fib3V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckluZm9PYmouYWJvdXQpO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJJbmZvT2JqLmF2YXRhcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICB0aGlzLl91c2VyRGF0YSA9IHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0RWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl91c2VyRGF0YTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihkYXRhKSB7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBkYXRhLnVybDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBnYWxsZXJ5U2VsZWN0b3IpIHtcbiAgICB0aGlzLl9nYWxsZXJ5ID0gZ2FsbGVyeVNlbGVjdG9yO1xuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIGNvbnNvbGUubG9nKGl0ZW1zKTtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLnJlbmRlcmVyKHRoaXMuX2dhbGxlcnksIGl0ZW0pO1xuICAgICAgY29uc29sZS5sb2coaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICByZW5kZXJJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9nYWxsZXJ5LnByZXBlbmQoaXRlbSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcFVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3BVcFNlbGVjdG9yKTtcbiAgICB0aGlzLmltYWdlRWxlbWVudCA9IHRoaXMuX3BvcFVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWwtcGljdHVyZV9faW1hZ2VcIlxuICAgICk7XG4gICAgdGhpcy50aXRsZUVsZW1lbnQgPSB0aGlzLl9wb3BVcEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsLXBpY3R1cmVfX3RpdGxlXCJcbiAgICApO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgdGhpcy5pbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xuICAgIHRoaXMuaW1hZ2VFbGVtZW50LmFsdCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLnRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcblxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoYmFzZVVybCwgdG9rZW4sIGZ1bmN0aW9uT2JqKSB7XG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLnRva2VuID0gdG9rZW47XG4gICAgdGhpcy5mdW5jT2JqID0gZnVuY3Rpb25PYmo7XG4gIH1cblxuICBnZXRVc2VyRGF0YSgpIHtcbiAgICBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLnRva2VuLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdXRzfWApO1xuICAgICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdGhpcy5mdW5jT2JqLnNldFVzZXJJbmZvKHJlcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICB1cGRhdGVVc2VyRGF0YShkYXRhKSB7XG4gICAgZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLnRva2VuLFxuICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgICAgdGhpcy5mdW5jT2JqLnJlbmRlclNhdmluZ1Byb2ZpbGVGb3JtKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBnZXRJbml0YWlhbENhcmRzKCkge1xuICAgIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMudG9rZW4sXG4gICAgICB9LFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICByZXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgIHRoaXMuZnVuY09iai5jYXJkUmVxdWVzdChpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBwb3N0Q2FyZChkYXRhKSB7XG4gICAgZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMudG9rZW4sXG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS50aXRsZSxcbiAgICAgICAgbGluazogZGF0YS5saW5rLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICAgIHRoaXMuZnVuY09iai5jYXJkUmVxdWVzdChyZXMpO1xuICAgICAgICB0aGlzLmZ1bmNPYmoucmVuZGVyU2F2aW5nTmV3Q2FyZEZvcm0oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcInRoaXMgaXMgcG9zdENhcmQgY2F0Y2hcIik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChkYXRhKSB7XG4gICAgZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2RhdGEuX2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy50b2tlbixcbiAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oY29uc29sZS5sb2coYCR7ZGF0YS5uYW1lfSBpZC0ke2RhdGEuX2lkfSBoYXMgYmVlbiBkZWxldGVkYCkpXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIGxpa2VDYXJkKGRhdGEpIHtcbiAgICBpZiAoZGF0YS5pc0xpa2VkKSB7XG4gICAgICBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7ZGF0YS5faWR9L2xpa2VzYCwge1xuICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLnRva2VuLFxuICAgICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2RhdGEuX2lkfS9saWtlc2AsIHtcbiAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy50b2tlbixcbiAgICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcGF0Y2hBdmF0YXIoZGF0YSkge1xuICAgIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMudG9rZW4sXG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBkYXRhLnVybCxcbiAgICAgIH0pLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICB0aGlzLmZ1bmNPYmouc2V0QXZhdGFyKHsgdXJsOiByZXMuYXZhdGFyIH0pO1xuICAgICAgICB0aGlzLmZ1bmNPYmoucmVuZGVyU2F2aW5nQXZhdGFyRm9ybSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0QXZhdGFyKCkge1xuICAgIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMudG9rZW4sXG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdGhpcy5mdW5jT2JqLnNldEF2YXRhcih7IHVybDogcmVzLmF2YXRhciB9KTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIGdldFNlcnZlckRhdGEoKSB7XG4gICAgdGhpcy5nZXRVc2VyRGF0YSgpO1xuICAgIHRoaXMuZ2V0QXZhdGFyKCk7XG4gICAgdGhpcy5nZXRJbml0YWlhbENhcmRzKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiZnVuY3Rpb25PYmplY3QiLCJ0aGlzIiwiX3RpdGxlIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsImhhbmRsZUxpa2UiLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiaGFuZGxlRGVsZXRlIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVJbWFnZUNsaWNrIiwiX2dldFRlbXBsYXRlIiwiY2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJjYXJkRGF0YU9iaiIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiaXNMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0b2dnbGUiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnT2JqIiwiZm9ybUVsZW1lbnQiLCJidG4iLCJzdWJtaXRCdG4iLCJpbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXQiLCJmb3JFYWNoIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhpZGVJbnB1dEVycm9yIiwic2hvd0lucHV0RXJyb3IiLCJldmVyeSIsImRpc2FibGVkIiwicmVzZXRWYWxpZGF0aW9uIiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wVXBTZWxlY3RvciIsIl9wb3BVcEVsZW1lbnQiLCJjbG9zZUJ1dHRvbiIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY29kZSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdEhhbmRsZXIiLCJzdXBlciIsIl9mb3JtSW5wdXRzIiwiX2hhbmRsZVN1Ym1pdENsaWNrIiwiX3NhdmVCdXR0b24iLCJyZW5kZXJTYXZpbmciLCJpbnB1dERhdGEiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIl9pbnB1dERhdGEiLCJ2YWx1ZSIsInNldERlbGV0ZVN1Ym1pdExpc3RlbmVyIiwiY2FyZCIsImlzU2F2aW5nIiwiY2FyZEdhbGxlcnlFTCIsImF2YXRhck92ZXJsYXkiLCJwcm9maWxlRm9ybSIsIm5ld1BsYWNlRm9ybSIsImF2YXRhckZvcm0iLCJpbWFnZURlbGV0ZUZvcm0iLCJpbnB1dE5hbWUiLCJpbnB1dFN1YnRpdGxlIiwicHJvZmlsZUVkaXRCdG4iLCJhZGROZXdJbWFnZUJ0biIsImNvbmZpZyIsImZvcm0iLCJ1c2VyIiwidXNlckluZm9PYmoiLCJfbmFtZUVsZW1lbnQiLCJfYWJvdXRFbGVtZW50IiwiYWJvdXQiLCJfYXZhdGFyRWxlbWVudCIsImF2YXRhciIsImdldFVzZXJJbmZvIiwiX3VzZXJEYXRhIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwidXJsIiwiaGFuZGxlckZ1bmN0aW9ucyIsIm9wZW5Qb3B1cCIsInBvcHVwSW1hZ2VEZWxldGUiLCJhcGlDYWxsIiwibGlrZUNhcmQiLCJwb3B1cFdpdGhJbWFnZSIsImFwaUZ1bmN0aW9uT2JqIiwiY2FyZFJlcXVlc3QiLCJjYXJkUmVuZGVyZXIiLCJnYWxsZXJ5U2VjdGlvbiIsInNldEF2YXRhciIsInJlbmRlclNhdmluZ1Byb2ZpbGVGb3JtIiwicG9wdXBFZGl0UHJvZmlsZUZvcm0iLCJyZW5kZXJTYXZpbmdBdmF0YXJGb3JtIiwicG9wdXBBdmF0YXJGb3JtIiwicmVuZGVyU2F2aW5nTmV3Q2FyZEZvcm0iLCJwb3B1cE5ld0NhcmRGb3JtIiwicmVuZGVyZXIiLCJnYWxsZXJ5U2VsZWN0b3IiLCJfZ2FsbGVyeSIsInJlbmRlckl0ZW1zIiwiY29uc29sZSIsImxvZyIsIml0ZW1zIiwiaXRlbSIsInJlbmRlckl0ZW0iLCJwcmVwZW5kIiwicHJvZmlsZVZhbGlkYXRvciIsIm5ld1BsYWNlVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImltYWdlRGVsZXRlRm9ybVZhbGlkYXRvciIsImRlbGV0ZUNhcmQiLCJpbWFnZUVsZW1lbnQiLCJ0aXRsZUVsZW1lbnQiLCJwb3N0Q2FyZCIsInVwZGF0ZVVzZXJEYXRhIiwicGF0Y2hBdmF0YXIiLCJiYXNlVXJsIiwidG9rZW4iLCJmdW5jdGlvbk9iaiIsImZ1bmNPYmoiLCJnZXRVc2VyRGF0YSIsImZldGNoIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXV0cyIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInN0YXR1cyIsImdldEluaXRhaWFsQ2FyZHMiLCJ0aXRsZSIsIl9pZCIsImdldEF2YXRhciIsImdldFNlcnZlckRhdGEiLCJwb3B1cCIsInNlY3Rpb24iLCJjcmVhdENhcmQiLCJ1c2VyUHJvZmlsZSJdLCJzb3VyY2VSb290IjoiIn0=